# Default values for ezl-app-server.
# This is a YAML-formatted file.
# Declare variables to be passed into your templates.

global:
  image:
    tag: latest
  subImage:
    tag: ""
  volumes: 
    - name: secrets-volume
      csi:
        driver: secrets-store.csi.k8s.io
        readOnly: true
        volumeAttributes:
          secretProviderClass: ezl-app-server
  volumeMounts:
    - name: secrets-volume
      mountPath: "/mnt/secrets-store"
      readOnly: true
  envFrom:
    - secretRef:
        name: ezl-app-server

replicaCount: 1
revisionHistoryLimit: 3

image:
  repository: svvwac98/ezl-app-server-log-generator
  pullPolicy: IfNotPresent
  # Overrides the image tag whose default is the chart appVersion.
  tag: ""

imagePullSecrets: []
nameOverride: ""
fullnameOverride: ""

serviceAccount:
  # Specifies whether a service account should be created
  create: true
  # Automatically mount a ServiceAccount's API credentials?
  automount: true
  # Annotations to add to the service account
  annotations: {}
  # The name of the service account to use.
  # If not set and create is true, a name is generated using the fullname template
  name: ""

podAnnotations: {}
podLabels: {}

podSecurityContext: {}
  # fsGroup: 2000

securityContext: {}
  # capabilities:
  #   drop:
  #   - ALL
  # readOnlyRootFilesystem: true
  # runAsNonRoot: true
  # runAsUser: 1000

service:
  type: ClusterIP
  port: 8000

ingress:
  enabled: false
  className: ""
  annotations:
    nginx.ingress.kubernetes.io/proxy-body-size: "5m"
    # kubernetes.io/ingress.class: nginx
    # kubernetes.io/tls-acme: "true"
  hosts:
    - host: chart-example.local
      path: /
      pathType: ImplementationSpecific
      whitelist:
        - 0.0.0.0/0
      denylist:
        - 192.168.0.1
  tls: []
  #  - secretName: chart-example-tls
  #    hosts:
  #      - chart-example.local

resources: {}
  # We usually recommend not to specify default resources and to leave this as a conscious
  # choice for the user. This also increases chances charts run on environments with little
  # resources, such as Minikube. If you do want to specify resources, uncomment the following
  # lines, adjust them as necessary, and remove the curly braces after 'resources:'.
  # limits:
  #   cpu: 100m
  #   memory: 128Mi
  # requests:
  #   cpu: 100m
  #   memory: 128Mi

# startupProbe:
#   httpGet:
#     path: /api/intgapp/ping/
#     port: 8000
#   failureThreshold: 10
#   initialDelaySeconds: 20
#   periodSeconds: 5
#   timeoutSeconds: 60
# livenessProbe:
#   httpGet:
#     path: /api/intgapp/ping/
#     port: 8000
#   failureThreshold: 3
#   periodSeconds: 5
#   timeoutSeconds: 60
# readinessProbe:
#   httpGet:
#     path: /api/intgapp/ping/
#     port: 8000
#   failureThreshold: 3
#   periodSeconds: 5
#   timeoutSeconds: 60

# KEDA 기반 오토스케일링 설정
autoscaling:
  enabled: false
  minReplicas: 1
  maxReplicas: 10
  pollingInterval: 10  # 감시하는 주기 (초)
  cooldownPeriod: 60  # 쿨다운 주기 (초)
  triggers:
    cpu:
      enabled: false
      targetUtilization: "80"
    memory:
      enabled: false
      targetUtilization: "80"
    rps:
      enabled: false
      targetRPS: "10"
    api:
      enabled: false
  # #Cron 기반 스케일링 (여러 개 설정 가능)
  # cron:
  #   # 1. 매월 20일 오전 10시부터 16시까지 운영계 앱서버 최소 파드 수가 7개로 조정되어야한다
  #   - name: "monthly-20events"
  #     timezone: "Asia/Seoul"
  #     start: "0 10 20 * *"   
  #     end: "0 16 20 * *"
  #     desiredReplicas: 7  

# Additional volumes on the output Deployment definition.
volumes: []

# Additional volumeMounts on the output Deployment definition.
volumeMounts: []

nodeSelector: {}

tolerations: []

affinity: {}

command:
- bash
args:
- /app/log-generator.sh

secret:
  secretName: ezl-app-server-secrets
  secretKey:
  - API_KEY
  - FCM_CERTIFICATE_FILE_KEY
  - CASHBEE3_FCM_CERTIFICATE_FILE_KEY
  - CASHBEE_CHARGE_FCM_CERTIFICATE_FILE_KEY
  - BACKOFFICE_USER_JWT_SECRET
  - BACKOFFICE_USER_PASSWORD_SECRET
  - CELERY_BROKER_URL
  - CMS_API_BASE_URL
  - CMS_TOKEN
  - DB_HOST
  - DB_NAME
  - DB_PASSWORD
  - DB_PORT
  - DB_USER
  - DJANGO_SETTINGS_MODULE
  - ECMS_DB_NAME
  - HYPHEN_AES256HEXKEY
  - HYPHEN_BASE_URL
  - HYPHEN_CLIENT_TOKEN
  - HYPHEN_SEQUENCE_NO
  - SENTRY_DSN
  - SECRET_KEY
  - USER_DATA_ENCRYPT_SALT
  - CELERY_BROKER_CONNECTION_STRING
  - AWS_CLOUDFRONT_URL
  - INTGAPP_USER_JWT_SECRET
  - EZL_AES256KEY
  - BUZZBOOSTER_IOS_APP_ID
  - BUZZBOOSTER_AOS_APP_ID
  - PAYMENT_PASSWORD_HASH_SALT
  - KAKAO_APP_ADMIN_KEY
  - EZLWALK_POINT_EXPIRE_PERIOD_DAYS
  - BUZZBOOSTER_POINT_EXPIRE_PERIOD_DAYS
  - BUZZBENEFIT_POINT_EXPIRE_PERIOD_DAYS
  - NASMEDIA_POINT_EXPIRE_PERIOD_DAYS
  - HEALTHCHECK_API_KEY
  - URL_SHORTENER_API_BASE_URL
  - DEV_DB_HOST
  - DEV_DB_NAME
  - DEV_DB_PASSWORD
  - DEV_DB_PORT
  - DEV_DB_USER
  - SES_ROLE_ARN
  - EMAIL_RESULT_SQS_URL
  - EZL_APPLICATION_SQS_QUEUE_URL
  - EZL_PUSH_NOTIFICATION_EVENTS_SQS_URL
  - USER_CI_ENCRYPT_KEY